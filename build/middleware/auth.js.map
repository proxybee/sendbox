{"version":3,"sources":["../../src/middleware/auth.js"],"names":["dotenv","config","Auth","req","res","next","bearerHeader","headers","authorization","query","token","jwt","verify","process","env","JWT_SECRET","err","data","console","log","status","send","user","username","email","adminStatus","isAdmin","json","message"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;AACA;AAEAA,mBAAOC,MAAP;;IAEMC,I;;;;;;;WACJ,qBAAmBC,GAAnB,EAAwBC,GAAxB,EAA6BC,IAA7B,EAAmC;AACjC,UAAMC,YAAY,GAAGH,GAAG,CAACI,OAAJ,CAAYC,aAAZ,IAA6BL,GAAG,CAACM,KAAJ,CAAUC,KAA5D;;AACA,UAAI,OAAOJ,YAAP,KAAwB,WAA5B,EAAyC;AACvCH,QAAAA,GAAG,CAACO,KAAJ,GAAYJ,YAAZ;;AACAK,iCAAIC,MAAJ,CAAWT,GAAG,CAACO,KAAf,EAAsBG,OAAO,CAACC,GAAR,CAAYC,UAAlC,EAA8C,UAACC,GAAD,EAAMC,IAAN,EAAe;AAC3DC,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ,EAAyBF,IAAzB;;AACA,cAAID,GAAJ,EAAS;AACPZ,YAAAA,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,4CAArB;AACD,WAFD,MAEO;AACLlB,YAAAA,GAAG,CAACmB,IAAJ,GAAWL,IAAI,CAACM,QAAhB;AACApB,YAAAA,GAAG,CAACqB,KAAJ,GAAYP,IAAI,CAACO,KAAjB;AACArB,YAAAA,GAAG,CAACsB,WAAJ,GAAkBR,IAAI,CAACS,OAAvB;AACArB,YAAAA,IAAI;AACL;AACF,SAVD;AAWD,OAbD,MAaO;AACLD,QAAAA,GAAG,CAACgB,MAAJ,CAAW,GAAX,EAAgBO,IAAhB,CAAqB;AAAEP,UAAAA,MAAM,EAAE,GAAV;AAAeQ,UAAAA,OAAO,EAAE;AAAxB,SAArB;AACD;AACF;;;;;eAGY1B,I","sourcesContent":["import jwt from 'jsonwebtoken';\nimport dotenv from 'dotenv';\n// import db from '../models';\n\ndotenv.config();\n\nclass Auth {\n  static verifyToken(req, res, next) {\n    const bearerHeader = req.headers.authorization || req.query.token;\n    if (typeof bearerHeader !== 'undefined') {\n      req.token = bearerHeader;\n      jwt.verify(req.token, process.env.JWT_SECRET, (err, data) => {\n        console.log('auth data', data);\n        if (err) {\n          res.status(403).send('You are not authorized to access this page');\n        } else {\n          req.user = data.username;\n          req.email = data.email;\n          req.adminStatus = data.isAdmin;\n          next();\n        }\n      });\n    } else {\n      res.status(403).json({ status: 403, message: 'Forbidden' });\n    }\n  }\n}\n\nexport default Auth;\n"],"file":"auth.js"}